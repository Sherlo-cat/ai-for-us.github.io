---
// Header Component - Navigation with glassmorphism effect
import { type Language, languages, languageFlags } from '@/i18n/config';
import { useTranslations, getLocalizedPath, getLanguageSwitchUrl } from '@/i18n';
import ThemeToggle from './ThemeToggle.astro';

interface Props {
  lang: Language;
}

const { lang } = Astro.props;
const t = useTranslations(lang);

const navItems = [
  { key: 'nav.home', path: '' },
  { key: 'nav.blog', path: 'blog' },
  { key: 'nav.about', path: 'about' },
];

// Get the current path for language switching
const currentPath = Astro.url.pathname;
---

<header class="fixed top-0 left-0 right-0 z-50 glass">
  <nav class="container-custom">
    <div class="flex items-center justify-between h-16">
      <!-- Logo -->
      <a 
        href={getLocalizedPath('', lang)} 
        class="flex items-center space-x-2 text-neon-cyan hover:text-electric-purple transition-colors"
      >
        <svg class="w-8 h-8" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="16" cy="16" r="14" stroke="currentColor" stroke-width="2"/>
          <circle cx="16" cy="16" r="6" fill="currentColor"/>
          <path d="M16 2V8M16 24V30M2 16H8M24 16H30" stroke="currentColor" stroke-width="2"/>
        </svg>
        <span class="font-bold text-lg">AI for Us</span>
      </a>
      
      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-8">
        {navItems.map((item) => (
          <a 
            href={getLocalizedPath(item.path, lang)}
            class="link-underline text-slate-200 hover:text-neon-cyan transition-colors"
          >
            {t(item.key)}
          </a>
        ))}
      </div>
      
      <!-- Right Side: Language & Theme -->
      <div class="flex items-center space-x-4">
        <!-- Language Switcher - Simple toggle between EN and ZH -->
        <a 
          href={getLanguageSwitchUrl(currentPath, lang)}
          class="flex items-center space-x-1 text-slate-200 hover:text-neon-cyan transition-colors px-3 py-1 rounded-full border border-slate-600 hover:border-neon-cyan"
          aria-label="Switch language"
        >
          <span>{lang === 'en' ? 'ðŸ‡¨ðŸ‡³' : 'ðŸ‡ºðŸ‡¸'}</span>
          <span class="hidden sm:inline text-sm">{lang === 'en' ? 'ä¸­æ–‡' : 'English'}</span>
        </a>
        
        <!-- Theme Toggle -->
        <ThemeToggle />
        
        <!-- Mobile Menu Button -->
        <button 
          id="mobile-menu-btn"
          class="md:hidden p-2 text-slate-200 hover:text-neon-cyan transition-colors"
          aria-label="Toggle menu"
        >
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>
    
    <!-- Mobile Navigation -->
    <div id="mobile-menu" class="hidden md:hidden pb-4">
      {navItems.map((item) => (
        <a 
          href={getLocalizedPath(item.path, lang)}
          class="block py-2 text-slate-200 hover:text-neon-cyan transition-colors"
        >
          {t(item.key)}
        </a>
      ))}
    </div>
  </nav>
</header>

<script>
  function initMobileMenu() {
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');
    
    btn?.addEventListener('click', () => {
      menu?.classList.toggle('hidden');
    });
  }
  
  document.addEventListener('DOMContentLoaded', initMobileMenu);
  document.addEventListener('astro:page-load', initMobileMenu);
</script>
